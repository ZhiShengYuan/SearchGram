{
  "_comment": "SearchGram Configuration File - See CONFIG_REFERENCE.md for detailed documentation of all fields",
  "telegram": {
    "app_id": 123456,
    "app_hash": "your_app_hash_here",
    "bot_token": "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11",
    "owner_id": 260260121,
    "proxy": null,
    "ipv6": false
  },
  "services": {
    "_comment": "Inter-service communication endpoints (RESTful HTTP APIs)",
    "bot": {
      "base_url": "http://127.0.0.1:8081"
    },
    "userbot": {
      "base_url": "http://127.0.0.1:8082"
    },
    "search": {
      "base_url": "http://127.0.0.1:8080"
    }
  },
  "auth": {
    "_comment": "JWT authentication for inter-service communication (Ed25519)",
    "use_jwt": true,
    "issuer": "bot",
    "audience": "internal",
    "_key_format_comment": "Keys can be file paths OR inline (single-line string with \\n OR JSON array)",
    "public_key_path": "keys/public.key",
    "private_key_path": "keys/private.key",
    "public_key_inline": null,
    "private_key_inline": null,
    "_inline_example_single_line": "-----BEGIN PUBLIC KEY-----\\nMCowBQYD...\\n-----END PUBLIC KEY-----",
    "_inline_example_json_array": ["-----BEGIN PUBLIC KEY-----", "MCowBQYDK2VwAyEA...", "-----END PUBLIC KEY-----"],
    "token_ttl": 300
  },
  "http": {
    "_comment": "HTTP server settings for bot/userbot services",
    "listen": "127.0.0.1",
    "bot_port": 8081,
    "userbot_port": 8082,
    "search_port": 8080,
    "message_queue_db": "message_queue.db",
    "cleanup_interval_hours": 24
  },
  "search_engine": {
    "_comment": "Only 'http' engine is supported (legacy engines removed)",
    "engine": "http",
    "_endpoint_comment": "Search service endpoint is configured in services.search.base_url",
    "batch": {
      "_comment": "Batch insert settings for improved performance",
      "enabled": true,
      "size": 100,
      "flush_interval": 1.0
    },
    "http": {
      "_comment": "HTTP client settings for search service communication (uses JWT auth from auth section)",
      "timeout": 30,
      "max_retries": 3
    }
  },
  "search_service": {
    "_comment": "Go search service (searchgram-engine) configuration",
    "server": {
      "host": "127.0.0.1",
      "port": 8080,
      "read_timeout": "30s",
      "write_timeout": "30s"
    },
    "elasticsearch": {
      "host": "http://localhost:9200",
      "username": "elastic",
      "password": "changeme",
      "index": "telegram",
      "shards": 3,
      "replicas": 1
    },
    "logging": {
      "level": "info",
      "format": "json",
      "_level_options": ["debug", "info", "warn", "error"],
      "_format_options": ["json", "text"]
    },
    "cache": {
      "enabled": false,
      "ttl": "300s"
    }
  },
  "bot": {
    "_mode_comment": "Mode can be a single string ('private', 'group', 'public') or array (['private', 'group'])",
    "mode": "private",
    "_mode_examples": {
      "private_only": "private",
      "group_only": "group",
      "multi_mode": ["private", "group"],
      "public": "public"
    },
    "allowed_groups": [],
    "_allowed_groups_example": [-1001234567890, -1009876543210],
    "_allowed_groups_comment": "All groups that are indexed and searchable (defines the complete set of groups)",
    "allowed_users": [],
    "_allowed_users_example": [123456789, 987654321],
    "_allowed_users_comment": "Users who can use the bot (must also be configured in user_group_permissions for group access)",
    "admins": [],
    "_admins_example": [111111111, 222222222],
    "_admins_comment": "Admin users who can search ALL indexed groups (from allowed_groups). Admins are like owner but without admin command access.",
    "user_group_permissions": {},
    "_user_group_permissions_example": {
      "123456789": [-1001234567890],
      "987654321": [-1009876543210, -1001234567890]
    },
    "_user_group_permissions_comment": "Per-user group access control. Maps user_id (as string) to array of group_ids they can search. Users not listed or with empty array can't search any groups. Owner and admins bypass this."
  },
  "privacy": {
    "storage_file": "privacy_data.json"
  },
  "database": {
    "enabled": true,
    "path": "searchgram_logs.db",
    "_comment": "SQLite database for query logs and admin settings. Disable if you don't want query logging."
  },
  "sync": {
    "enabled": true,
    "checkpoint_file": "sync_progress.json",
    "batch_size": 100,
    "retry_on_error": true,
    "max_retries": 3,
    "resume_on_restart": true,
    "delay_between_batches": 1.0,
    "_delay_comment": "Delay in seconds between processing batches to avoid Telegram FloodWait rate limits. Recommended: 0.5-2.0 seconds",
    "clear_completed": false,
    "_clear_completed_comment": "If false (recommended), keeps completed chats in checkpoint to prevent re-sync on restart. If true, removes them after sync completes.",
    "chats": []
  }
}
